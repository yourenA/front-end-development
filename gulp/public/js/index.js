"use strict";

var zNodes = [{ id: 1, name: "A" }, { id: 2, name: "B" }, { id: 3, name: "C" }, { id: 31, pId: 3, name: "C1" }, { id: 36, pId: 31, name: "z" }, { id: 37, pId: 36, name: "z1123" }, { id: 38, pId: 37, name: "z123123123" }];
for (var i = 0, len = zNodes.length; i < len; i++) {
    if (zNodes[i].pId === undefined) {
        console.log('不存在pid');
    }
}
console.log(zNodes);
function treeMenu(a) {
    this.tree = a || []; //this.tree 为 传入的数组
    this.groups = {};
};
treeMenu.prototype = {
    init: function init(pid) {
        this.group(); // pid为要获取的id

        return this.getDom(this.groups[pid]);
    },
    group: function group() {
        for (var i = 0; i < this.tree.length; i++) {
            if (this.groups[this.tree[i].pId]) {
                this.groups[this.tree[i].pId].push(this.tree[i]);
            } else {
                this.groups[this.tree[i].pId] = [];
                this.groups[this.tree[i].pId].push(this.tree[i]);
            }
        }
    },
    getDom: function getDom(a) {
        if (!a) {
            return '';
        }
        var html = '\n<ul >\n';
        for (var i = 0; i < a.length; i++) {
            html += '<li><a href="' + a[i].id + '">' + a[i].name + '</a>';
            html += this.getDom(this.groups[a[i].id]);
            html += '</li>\n';
        };
        html += '</ul>\n';
        return html;
    }
};
var html = new treeMenu(zNodes).init(0);

var tree = zNodes.reduce(function (o, x) {
    var id = x.id;
    var pId = x.pId;
    o[id] = o[id] || { children: [] };
    o[id].node = x;
    if (pId) {
        o[pId] = o[pId] || { children: [] //改变父节点对象
        };o[pId].children.push(x);
    }
    console.log('o', o);
    return o;
}, {});

var node = { id: 38, pId: 37, name: "z123123123" };
console.log(listParents(tree, node).map(function (x) {
    return x.name;
}).concat(node.name).join(' -> '));

console.log(listFirstChildren(tree, node).map(function (x) {
    return x.name;
}).join(' -> '));

function listParents(tree, node) {
    if (!node.pId) {
        return [];
    }

    return _list(tree, tree[node.pId].node);

    function _list(tree, node) {
        console.log(node);
        if (node.pId === undefined) {
            return [node]; //当没有pid的时候结束递归。跳出结构,有了跳出才有结果
        } else {
            return _list(tree, tree[node.pId].node).concat([node]); //递归，递归一般都是通过return
        }
    }
}

function listFirstChildren(tree, node) {
    if (tree[node.id].children.length <= 0) {
        return [];
    }

    return _list(tree, tree[node.id].children[0]);

    function _list(tree, node) {
        if (tree[node.id].children.length <= 0) {
            return [node];
        } else {
            return [node].concat(_list(tree, tree[node.id].children[0]));
        }
    }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInpOb2RlcyIsImlkIiwibmFtZSIsInBJZCIsImkiLCJsZW4iLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwibG9nIiwidHJlZU1lbnUiLCJhIiwidHJlZSIsImdyb3VwcyIsInByb3RvdHlwZSIsImluaXQiLCJwaWQiLCJncm91cCIsImdldERvbSIsInB1c2giLCJodG1sIiwicmVkdWNlIiwibyIsIngiLCJjaGlsZHJlbiIsIm5vZGUiLCJsaXN0UGFyZW50cyIsIm1hcCIsImNvbmNhdCIsImpvaW4iLCJsaXN0Rmlyc3RDaGlsZHJlbiIsIl9saXN0Il0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLFNBQU8sQ0FDUCxFQUFDQyxJQUFHLENBQUosRUFBTUMsTUFBSyxHQUFYLEVBRE8sRUFFUCxFQUFDRCxJQUFHLENBQUosRUFBTUMsTUFBSyxHQUFYLEVBRk8sRUFHUCxFQUFDRCxJQUFHLENBQUosRUFBTUMsTUFBSyxHQUFYLEVBSE8sRUFJUCxFQUFDRCxJQUFHLEVBQUosRUFBT0UsS0FBSSxDQUFYLEVBQWFELE1BQUssSUFBbEIsRUFKTyxFQUtQLEVBQUNELElBQUcsRUFBSixFQUFPRSxLQUFJLEVBQVgsRUFBY0QsTUFBSyxHQUFuQixFQUxPLEVBTVAsRUFBQ0QsSUFBRyxFQUFKLEVBQU9FLEtBQUksRUFBWCxFQUFjRCxNQUFLLE9BQW5CLEVBTk8sRUFPUCxFQUFDRCxJQUFHLEVBQUosRUFBT0UsS0FBSSxFQUFYLEVBQWNELE1BQUssWUFBbkIsRUFQTyxDQUFYO0FBU0EsS0FBSSxJQUFJRSxJQUFFLENBQU4sRUFBUUMsTUFBSUwsT0FBT00sTUFBdkIsRUFBOEJGLElBQUVDLEdBQWhDLEVBQW9DRCxHQUFwQyxFQUF3QztBQUNwQyxRQUFHSixPQUFPSSxDQUFQLEVBQVVELEdBQVYsS0FBZ0JJLFNBQW5CLEVBQTZCO0FBQ3pCQyxnQkFBUUMsR0FBUixDQUFZLFFBQVo7QUFDSDtBQUNKO0FBQ0RELFFBQVFDLEdBQVIs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UDtBQUNIOztBQUVELFdBQU95QixNQUFNbkIsSUFBTixFQUFZQSxLQUFLYSxLQUFLeEIsRUFBVixFQUFjdUIsUUFBZCxDQUF1QixDQUF2QixDQUFaLENBQVA7O0FBRUEsYUFBU08sS0FBVCxDQUFnQm5CLElBQWhCLEVBQXNCYSxJQUF0QixFQUE0QjtBQUN4QixZQUFJYixLQUFLYSxLQUFLeEIsRUFBVixFQUFjdUIsUUFBZCxDQUF1QmxCLE1BQXZCLElBQWlDLENBQXJDLEVBQXdDO0FBQ3BDLG1CQUFPLENBQUNtQixJQUFELENBQVA7QUFDSCxTQUZELE1BRU87QUFDSCxtQkFBTyxDQUFDQSxJQUFELEVBQU9HLE1BQVAsQ0FBY0csTUFBTW5CLElBQU4sRUFBWUEsS0FBS2EsS0FBS3hCLEVBQVYsRUFBY3VCLFFBQWQsQ0FBdUIsQ0FBdkIsQ0FBWixDQUFkLENBQVA7QUFDSDtBQUNKO0FBQ0oiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgek5vZGVzPVtcclxuICAgIHtpZDoxLG5hbWU6XCJBXCJ9LFxyXG4gICAge2lkOjIsbmFtZTpcIkJcIn0sXHJcbiAgICB7aWQ6MyxuYW1lOlwiQ1wifSxcclxuICAgIHtpZDozMSxwSWQ6MyxuYW1lOlwiQzFcIn0sXHJcbiAgICB7aWQ6MzYscElkOjMxLG5hbWU6XCJ6XCJ9LFxyXG4gICAge2lkOjM3LHBJZDozNixuYW1lOlwiejExMjNcIn0gLFxyXG4gICAge2lkOjM4LHBJZDozNyxuYW1lOlwiejEyMzEyMzEyM1wifVxyXG5dO1xyXG5mb3IobGV0IGk9MCxsZW49ek5vZGVzLmxlbmd0aDtpPGxlbjtpKyspe1xyXG4gICAgaWYoek5vZGVzW2ldLnBJZD09PXVuZGVmaW5lZCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ+S4jeWtmOWcqHBpZCcpXHJcbiAgICB9XHJcbn1cclxuY29uc29sZS5sb2coek5vZGVzKVxyXG5mdW5jdGlvbiB0cmVlTWVudShhKXtcclxuICAgIHRoaXMudHJlZT1hfHxbXTsvL3RoaXMudHJlZSDkuLog5Lyg5YWl55qE5pWw57uEXHJcbiAgICB0aGlzLmdyb3Vwcz17fTtcclxufTtcclxudHJlZU1lbnUucHJvdG90eXBlPXtcclxuICAgIGluaXQ6ZnVuY3Rpb24ocGlkKXtcclxuICAgICAgICB0aGlzLmdyb3VwKCk7IC8vIHBpZOS4uuimgeiOt+WPlueahGlkXHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmdldERvbSh0aGlzLmdyb3Vwc1twaWRdKTtcclxuICAgIH0sXHJcbiAgICBncm91cDpmdW5jdGlvbigpe1xyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy50cmVlLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICBpZih0aGlzLmdyb3Vwc1t0aGlzLnRyZWVbaV0ucElkXSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3Vwc1t0aGlzLnRyZWVbaV0ucElkXS5wdXNoKHRoaXMudHJlZVtpXSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncm91cHNbdGhpcy50cmVlW2ldLnBJZF09W107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3Vwc1t0aGlzLnRyZWVbaV0ucElkXS5wdXNoKHRoaXMudHJlZVtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0RG9tOmZ1bmN0aW9uKGEpe1xyXG4gICAgICAgIGlmKCFhKXtyZXR1cm4gJyd9XHJcbiAgICAgICAgdmFyIGh0bWw9J1xcbjx1bCA+XFxuJztcclxuICAgICAgICBmb3IodmFyIGk9MDtpPGEubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIGh0bWwrPSc8bGk+PGEgaHJlZj1cIicrYVtpXS5pZCsnXCI+JythW2ldLm5hbWUrJzwvYT4nO1xyXG4gICAgICAgICAgICBodG1sKz10aGlzLmdldERvbSh0aGlzLmdyb3Vwc1thW2ldLmlkXSk7XHJcbiAgICAgICAgICAgIGh0bWwrPSc8L2xpPlxcbic7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBodG1sKz0nPC91bD5cXG4nO1xyXG4gICAgICAgIHJldHVybiBodG1sO1xyXG4gICAgfVxyXG59O1xyXG52YXIgaHRtbD1uZXcgdHJlZU1lbnUoek5vZGVzKS5pbml0KDApO1xyXG5cclxuXHJcbnZhciB0cmVlID0gek5vZGVzLnJlZHVjZSgobywgeCkgPT4ge1xyXG4gICAgbGV0IGlkID0geC5pZFxyXG4gICAgbGV0IHBJZCA9IHgucElkXHJcbiAgICBvW2lkXSA9IG9baWRdIHx8IHtjaGlsZHJlbjogW119XHJcbiAgICBvW2lkXS5ub2RlID0geFxyXG4gICAgaWYgKHBJZCkge1xyXG4gICAgICAgIG9bcElkXSA9IG9bcElkXSB8fCB7Y2hpbGRyZW46IFtdfSAvL+aUueWPmOeItuiKgueCueWvueixoVxyXG4gICAgICAgIG9bcElkXS5jaGlsZHJlbi5wdXNoKHgpXHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZygnbycsbylcclxuICAgIHJldHVybiBvXHJcbn0sIHt9KVxyXG5cclxudmFyIG5vZGUgPSB7aWQ6MzgscElkOjM3LG5hbWU6XCJ6MTIzMTIzMTIzXCJ9XHJcbmNvbnNvbGUubG9nKGxpc3RQYXJlbnRzKHRyZWUsIG5vZGUpLm1hcCh4ID0+IHgubmFtZSkuY29uY2F0KG5vZGUubmFtZSkuam9pbignIC0+ICcpKVxyXG5cclxuY29uc29sZS5sb2cobGlzdEZpcnN0Q2hpbGRyZW4odHJlZSwgbm9kZSkubWFwKHggPT4geC5uYW1lKS5qb2luKCcgLT4gJykpXHJcblxyXG5mdW5jdGlvbiBsaXN0UGFyZW50cyh0cmVlLCBub2RlKSB7XHJcbiAgICBpZiAoIW5vZGUucElkKSB7XHJcbiAgICAgICAgcmV0dXJuIFtdXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIF9saXN0KHRyZWUsIHRyZWVbbm9kZS5wSWRdLm5vZGUpXHJcblxyXG4gICAgZnVuY3Rpb24gX2xpc3QgKHRyZWUsIG5vZGUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhub2RlKVxyXG4gICAgICAgIGlmIChub2RlLnBJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbbm9kZV0vL+W9k+ayoeaciXBpZOeahOaXtuWAmee7k+adn+mAkuW9kuOAgui3s+WHuue7k+aehCzmnInkuobot7Plh7rmiY3mnInnu5PmnpxcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gX2xpc3QodHJlZSwgdHJlZVtub2RlLnBJZF0ubm9kZSkuY29uY2F0KFtub2RlXSkgLy/pgJLlvZLvvIzpgJLlvZLkuIDoiKzpg73mmK/pgJrov4dyZXR1cm5cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxpc3RGaXJzdENoaWxkcmVuICh0cmVlLCBub2RlKSB7XHJcbiAgICBpZiAodHJlZVtub2RlLmlkXS5jaGlsZHJlbi5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgIHJldHVybiBbXVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBfbGlzdCh0cmVlLCB0cmVlW25vZGUuaWRdLmNoaWxkcmVuWzBdKVxyXG5cclxuICAgIGZ1bmN0aW9uIF9saXN0ICh0cmVlLCBub2RlKSB7XHJcbiAgICAgICAgaWYgKHRyZWVbbm9kZS5pZF0uY2hpbGRyZW4ubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtub2RlXVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbbm9kZV0uY29uY2F0KF9saXN0KHRyZWUsIHRyZWVbbm9kZS5pZF0uY2hpbGRyZW5bMF0pKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuXHJcbiJdfQ==
